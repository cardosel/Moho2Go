{% extends "dashboard_header.html" %}
{% load staticfiles %}

{% block pagetitle %}RRI Dashboard Analytics{% endblock pagetitle %}

{% block wrapper_styles %}
<link rel="stylesheet" href="{% static "animate/animate.css" %}"/>

<!-- Version 2.0 edition -->
<link rel="stylesheet" type="text/css" media="all" href="{% static "dashboard/css/dashboard.css" %}">
<link rel="stylesheet" href="{% static "awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" %}"/>
<link rel="stylesheet" href="{% static "dashboard/css/doughnut.legend.css" %}"/>
{% endblock wrapper_styles %}

{% block wrapper_scripts %}
<script src="{% static "slimScroll/jquery.slimscroll.min.js" %}"></script>
<script src="{% static "flot.curvedlines/curvedLines.js" %}"></script>
<script src="{% static "jquery.flot.spline/index.js" %}"></script>
<script src="{% static "peity/jquery.peity.min.js" %}"></script>
<!-- Version 2.0 edition -->
<script src="{% static "dashboard/js/doughnut.chart.js" %}"></script>
<script src="{% static "dashboard/js/doughnut.legend.js" %}"></script>

<!-- App scripts -->
<script src="{% static "dashboard/js/charts.js" %}"></script>

<script> // ratings_filters__form
	$(function() {
		$('span.ratings_filters__choice').click(function(event) {
			ratingsFiltersToggle(event);
		});

		$('#filter-data').click(function(event) {
			event.preventDefault();
			// portfolio
			var portfolio_name = $('#portfolio-filter').val();
			// advanced filter
			var advance_filter = $('#advanced-filter').val();
			apply_filter(portfolio_name, advance_filter);
		});

		$(document).click(function(event) { // document dropdown-menu reset
			if ($(event.target).is('input, span.ratings_filters__choice')) return;
			$('ul.ratings_filters__dropdown-menu').removeClass('js_visible');
			$('i.ratings_filters__icon').removeClass('pe-rotate-180');
			console.log($(event.target));
		});

		$('ul.ratings_filters__dropdown-menu').find('a').click(function(event) { // switch text function
			event.preventDefault();
			var $thisChoice = $(this).text();
			var filter_type = $(this).data('label');
			$('label' + '[' + 'for=' + filter_type + ']').children('span.ratings_filters__choice').text($thisChoice);
			// console.log($(this).data('label'));
			ratingsFiltersToggle(event);
			$(this).closest('ul.ratings_filters__dropdown-menu').find('a').removeClass('current');
			$(this).addClass('current');
			$('button#filter-data').click();
		});

		function ratingsFiltersToggle(event) { // toggle function
			var event_target = $(event.target);
			var eventRatings_filters__section = event_target.closest('div.ratings_filters__section');
			var section = $('div.ratings_filters__section');
			$(section).not(event_target.closest('div.ratings_filters__section')).find('ul.ratings_filters__dropdown-menu').removeClass('js_visible');
			$(section).not(event_target.closest('div.ratings_filters__section')).find('i.ratings_filters__icon').removeClass('pe-rotate-180');
			eventRatings_filters__section.find('ul.ratings_filters__dropdown-menu').toggleClass('js_visible');
			eventRatings_filters__section.find('i').toggleClass('pe-rotate-180');
		}

		function apply_filter(portfolio_filter, advance_filter) {
			{% if testing %}
				var url = "{% url 'dashboard-test' %}";
			{% else %}
				var url = "organization_dashboard.php";
			{% endif %}
			var query_params = [];
			if(portfolio_filter !== '') {
				query_params.push('portfolio=' + portfolio_filter);
			}
			if(advance_filter !== '') {
				query_params.push('filter=' + advance_filter);
			}
			if(query_params.length > 0) {
				url += '?' + query_params.join('&')
			}
			window.location = url;
		}
	});
</script>

<script>
	$(function() { // select.ratings_filters__select value toggle

		$('select.ratings_filters__select').change(function() {

			if ($('select.ratings_filters__select').val() == 'Advanced Filter:') {

				// $('span.ratings_filters__selection').text('Portfolio ABB');

				return;

			}

			// $('button#filter-data').click();

			// $('span.ratings_filters__selection').text( $('select.ratings_filters__select').val());

		});

	});
</script>

<script>
<!-- this is the chart at the top of the page -->
	$(function () {

		/**
		 * Flot charts data and options
		 */

		/** Flot #flot-line-chart_hist_dist data and options */
		var historicalDistributionСhartData = {

			color: "#fdafaf",

			data: {{ scores_default_distribution }}, // [ ["jan", 4], [0, 0], [5, 0], [10, 3], [22, 13], [34, 3], [39,0], [60,0], [100,0] ]

			splines: {
					show: true,
					tension: 0.4,
					lineWidth: 0.1,
					fill: true
					// fillColor: "#fdafaf"
			}

		};

		var historicalDistributionСhart = [

			historicalDistributionСhartData

		];

		var historicalDistributionСhartUsersOptions = {

			grid: {
				// tickColor: "transparent", // #f0f0f0
				borderWidth: 1,
				borderColor: "#f0f0f0", // #f0f0f0
				backgroundColor: "white",
				color: "transparent" // "#6a6c6f"
			},

			xaxis: {
				tickSize: 10,
				show: false
			},

			yaxis: {
				tickSize: 5,
				show: false
			}

		};

		$.plot($("#flot-line-chart_hist_dist"), historicalDistributionСhart, historicalDistributionСhartUsersOptions);

		// #flot-line-chart_hist_dist hover event function
		var historicalDistributionСhartData_default_color = historicalDistributionСhartData.color;

		document.getElementById("flot-line-chart_hist_dist").onmouseenter = function() {

			historicalDistributionСhartData.color = 'red';

			$.plot($("#flot-line-chart_hist_dist"), historicalDistributionСhart, historicalDistributionСhartUsersOptions);

			$.plot($("#flot-line-chart"), multiBars, chartUsersOptions);

		}

		document.getElementById("flot-line-chart_hist_dist").onmouseleave = function() {

			historicalDistributionСhartData.color = historicalDistributionСhartData_default_color;

			$.plot($("#flot-line-chart_hist_dist"), historicalDistributionСhart, historicalDistributionСhartUsersOptions);

			$.plot($("#flot-line-chart"), multiBars, chartUsersOptions);

		}



		/** Flot #flot-line-chart data and options */
		var multiBars = [

		historicalDistributionСhartData,

		{

			color: "#F44E2D",

			data: {{ fhr_scores.VHR }}, // [ [12, 2], [16,3], [19,4] ]

			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}

		},

		{

			color: "#FF9B2B",

			data: {{ fhr_scores.HR }}, // [ [20, 4], [21,5], [22,3], [23,5], [24,10], [25,5], [26,5], [27,9], [28,11], [29,5], [30,12], [31,7], [32,10], [33,10], [34,8], [35,5], [36,9], [37,10], [38,11], [39,7] ]

			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}

		},

		{

			color: "#FFF884",

			data: {{ fhr_scores.MR }}, // [ [40, 14], [41,7], [42,10], [43,10], [44,17], [45,7], [46,15], [47,7], [48,16], [49,9], [50,18], [51,17], [52,10], [53,10], [54,16], [55,15], [56,15], [57,16], [58,18], [59,13] ]

			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}

		},

		{

			color: "#1EBD40",

			data: {{ fhr_scores.LR }}, // [ [60, 15], [61,8], [62,10], [63,6], [64,15], [65,10], [66,7], [67,16], [68,12], [69,13], [70,15], [71,10], [72,15], [73,14], [74,27], [75,4], [76,10], [77,8], [78,25], [79,12] ]

			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}

		},

		{

			color: "#3397C9",

			data: {{ fhr_scores.VLR }}, // [ [80, 11], [81,10], [82,11], [83,26], [84,16], [85,12], [86,14], [87,13], [88,14], [89,12], [90,20], [91,11], [92,9], [93,7], [94,15], [95,5], [96,6], [97,8], [98,1], [99,1] ]

			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}

		}];

		var chartUsersOptions = {

			grid: {
				// tickColor: "transparent", // #f0f0f0
				borderWidth: 0,
				// borderColor: "transparent", // #f0f0f0
				color: "transparent" // "#6a6c6f"
			},

			xaxis: {
				tickSize: 10
			},

			yaxis: {
				tickSize: 5
			}

		};

		$.plot($("#flot-line-chart"), multiBars, chartUsersOptions);

		/* /**
		 * Flot charts 2 data and options
		 
		var chartIncomeData = [
			{
				label: "line",
				data: [ [1, 10], [2, 26], [3, 16], [4, 36], [5, 32], [6, 51], [7,61], [8,65], [9,70], [10, 80], [11, 90]  ]
			}
		];

		var chartIncomeOptions = {
			series: {
				lines: {
					show: true,
					lineWidth: 0,
					fill: true,
					fillColor: "#64cc34"

				}
			},
			colors: ["#62cb31"],
			grid: {
				show: false
			},
			legend: {
				show: false
			}
		};

		// $.plot($("#flot-income-chart"), chartIncomeData, chartIncomeOptions); */

	});

</script>

<script>
<!-- this is the chart at the top of the page -->
	$(function () {
		/**
		 * Flot charts data and options
		 */
		var multiBars = [{
			color: "#fdafaf",
			data: {{ scores_default_distribution }},
			splines: {
					show: true,
					tension: 0.4,
					lineWidth: 0.1,
					fill: true
					// fillColor: "#fdafaf"
			}
		},
		{
			color: "#FF0000",
			data: {{ fhr_scores.VHR }},
			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}
		},
		{
			color: "#FF9900",
			data: {{ fhr_scores.HR }},
			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}
		},
		{
			color: "#FFFF00",
			data: {{ fhr_scores.MR }},
			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}
		},
		{
			color: "#339966",
			data: {{ fhr_scores.LR }},
			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}
		},
		{
			color: "#0000FF",
			data: {{ fhr_scores.VLR }},
			bars: {
					show: true,
					lineWidth: 0,
					fill: 1,
					barWidth: 0.6,
					align: "center",
					horizontal: false
			}
		}];
		var chartUsersOptions = {
			grid: {
				tickColor: "transparent", // #f0f0f0
				borderWidth: 0,
				borderColor: 'transparent' // #f0f0f0
				// color: '#6a6c6f'
			},
			xaxis: {
				tickSize: 10
			}
		};

		$.plot($("#flot-line-chart"), multiBars, chartUsersOptions);

		/**
		 * Flot charts 2 data and options
		 */
		var chartIncomeData = [
			{
				label: "line",
				data: [ [1, 10], [2, 26], [3, 16], [4, 36], [5, 32], [6, 51], [7,61], [8,65], [9,70], [10, 80], [11, 90]  ]
			}
		];

		var chartIncomeOptions = {
			series: {
				lines: {
					show: true,
					lineWidth: 0,
					fill: true,
					fillColor: "#64cc34"

				}
			},
			colors: ["#62cb31"],
			grid: {
				show: false
			},
			legend: {
				show: false
			}
		};

		// $.plot($("#flot-income-chart"), chartIncomeData, chartIncomeOptions);

	});

</script>

<!-- change this later to the RRI analytics -->
<!-- script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-4625583-2', 'webapplayers.com');
	ga('send', 'pageview');

</script -->

<script>	// Doughnut chart

	var doughnutData = [
		{
			value: {{ risk_categories.VLR|floatformat }},
			color:"#3397C9",
			highlight: "rgba(51, 151, 201, 0.4)",
			label: "Very Low"
		},
		{
			value: {{ risk_categories.LR|floatformat }},
			color: "#1EBD40",
			highlight: "rgba(30, 189, 64, 0.5)",
			label: "Low"
		},
		{
			value: {{ risk_categories.MR|floatformat }},
			color: "#FFF884",
			highlight: "rgba(255, 248, 132, 0.5)",
			label: "Medium"
		},
		{
			value: {{ risk_categories.HR|floatformat }},
			color: "#FF9B2B",
			highlight: "rgba(255, 155, 43, 0.5)",
			label: "High"
		},
		{
			value: {{ risk_categories.VHR|floatformat }},
			color: "#F44E2D",
			highlight: "rgba(244, 78, 45, 0.5)",
			label: "Very High"
		}
	];

	var options = {
		animationSteps: 100,
		animationEasing: "easeOutQuart",
		responsive: true,
		maintainAspectRatio: true,
		showTooltips: true, // end global
		segmentShowStroke : true,
		segmentStrokeColor : "#fff",
		segmentStrokeWidth : 2,
		percentageInnerCutout : 46,
		animateRotate : true,
		animateScale : false,
		tooltipFontSize: 12,
		// tooltipTemplate:"<%=label%>: <%=value%>%"
	};

	window.onload = function() {
		var ctx = document.getElementById("myDoughnutChart").getContext("2d");
		var myDoughnutChart = new Chart(ctx).Doughnut(doughnutData, options);
		legend(document.getElementById("myDoughnutChart_legend"), doughnutData, options, "<%=label%>: <%=value%>%");
		var titleText_i = 0;
		var titleText = document.querySelectorAll("span.title-text");
		while (titleText[titleText_i]) { // append legend % values inside <p class="title-value">
			var thisTitleText = titleText[titleText_i];
			var thisTitleTextParent = thisTitleText.parentNode;
			var titleTextNodeValue = thisTitleText.childNodes[0].nodeValue;
			//var titleTextSliced = titleTextNodeValue.slice(-3);
			var titleTextSliced = titleTextNodeValue.split(': ')[1];
			thisTitleText.innerHTML = thisTitleText.innerHTML.split(': ')[0];
			//thisTitleText.innerHTML = thisTitleText.innerHTML.slice(0, -5);
			var newPForSlicedTitleText = document.createElement("P");
			newPForSlicedTitleText.className = newPForSlicedTitleText.className + " title-value";
			var newNodeForNewPForSlicedTitleText = document.createTextNode(titleTextSliced);
			newPForSlicedTitleText.appendChild(newNodeForNewPForSlicedTitleText);
			thisTitleTextParent.insertBefore(newPForSlicedTitleText, thisTitleTextParent.childNodes[0]);
			titleText_i++;
		}
	};
</script>




<script> // table.rritest_risk hover functions
	$(document).ready(function() {

		$('td.rritest_risk_table_left_hover').mouseenter(function() {

			$(this).parents('table.rritest_risk_table_left')
				.next('table.rritest_risk_table_right')
				.find('td.rritest_risk_table_right_to_show, div.rritest_risk_table_indicator_container')
				.addClass('active');
			$(this).parents('table.rritest_risk_table_left')
				.next('table.rritest_risk_table_right')
				.find('div.rritest_risk_table_indicator_container_to_hide')
				.addClass('inactive');

		});

		$('td.rritest_risk_table_left_hover').mouseleave(function() {

			$(this).parents('table.rritest_risk_table_left')
				.next('table.rritest_risk_table_right')
				.find('td.rritest_risk_table_right_to_show, div.rritest_risk_table_indicator_container')
				.removeClass('active');
			$(this).parents('table.rritest_risk_table_left')
				.next('table.rritest_risk_table_right')
				.find('div.rritest_risk_table_indicator_container_to_hide')
				.removeClass('inactive');

		});

		// rritest_risk_table data width function
		$('div.rritest_risk_table_indicator_container').each(function() {

			//dataSet($(this));

		});

		function dataSet(target) {

			target.children().each(function() {

				var rritestRiskTableBar = $(this);

				var x = Math.random();

				var random = x.toFixed(2) * 100;

				switch (rritestRiskTableBar.attr('class')) {

					case 'rritest_risk_table_indicator_orange':
					rritestRiskTableBar.css({width:	 (random / 10) + 88 + '%'});
					break;

					case 'rritest_risk_table_indicator_light_orange':
					rritestRiskTableBar.css({width:	 (random / 10) + 78 + '%'});
					break;

					case 'rritest_risk_table_indicator_green':
					rritestRiskTableBar.css({width:	 (random / 10) + 68 + '%'});
					break;

					case 'rritest_risk_table_indicator_blue':
					rritestRiskTableBar.css({width:	 (random / 10) + 38 + '%'});
					break;

				}

			});

			$('div.rritest_risk_table_indicator_red').css({width: 100 + '%'});

		}

	});
</script>

<script> // rritest_risk_table_scroll
	$(function() {
		$('div.rritest_risk_table_scroll').slimScroll({
				//width: '300px',
				height: '600px',
				size: '8px',
				position: 'right',
				color: '#b8b8bc',
				alwaysVisible: false,
				distance: '2px',
				start: 'top',
				railVisible: true,
				railColor: '#f2f3f7',
				railOpacity: 1,
				wheelStep: 10,
				allowPageScroll: true,
				disableFadeOut: true
			}).css({paddingRight: '15px'});
	});
</script>

{% endblock wrapper_scripts %}

{% block body_wrapper %}

<!-- Main Wrapper -->
	<div class="content animate-panel">
		<div class="row m-b-md print_m_b_50">
			<div class="col-lg-12 text-center animated-panel"> <!-- m-t-md -->
				<h2>ABB Supply Chain</h2>
				<p>Financial Health Overview and Analytics</p>
			</div>
		</div>

		<!-- row 2 -->
		<div class="row">

		<!-- row 2 panel 1-2  -->

			<div class="col-lg-6">
				<div class="hpanel">
					<!-- <div class="panel-heading">
						Ratings Filters
					</div> -->
					<div class="panel-body" style="overflow: hidden;">
						<div class="row">
							<div class="col-xs-8" style="z-index: 1;">
								<div class="font-bold m-b-xs">RATINGS FILTERS</div>
								<form class="ratings_filters__form">
									<span class="ratings_filters__selection">Portfolio:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
									<select id="portfolio-filter" class="ratings_filters__select">
										<!-- <option>Portfolio Filter:</option> -->
										<option value="">Default Portfolio</option>
										{% for p_id, p_name in user_portfolios %}
											{% if p_id == current_portfolio %}
												<option value="{{ p_id }}" selected>{{ p_name }}</option>
											{% else %}
												<option value="{{ p_id }}">{{ p_name }}</option>
											{% endif %}
										{% endfor %}
									</select>
									{% if filters.names %}
										<br />
										<span class="ratings_filters__selection">Advanced Filter:</span>
										<select id="advanced-filter" class="ratings_filters__select">
											<!-- <option>Advanced Filter:</option> -->
											<option value="">None</option>
											{% for f_name, f_value in filters.names %}
												{% if f_name == filters.selected %}
													<option value="{{ f_name }}" selected>{{ f_value }}</option>
												{% else %}
													<option value="{{ f_name }}">{{ f_value }}</option>
												{% endif %}
											{% endfor %}
										</select>
									{% else %}
										<br /><br /><br />
									{% endif %}
									<button id="filter-data" type="button" class="btn w-xs btn-success">Filter</button>
								</form>
							</div>
							<div class="col-xs-4 rated_companies_container">
							<div class="rated_companies_background"></div>
								<!-- <div class="hpanel hbgblue" style="margin-bottom: 0;"> -->
									<!-- <div class="panel-body"> -->
										<div class="rated_companies">
											<!-- <h3>Total</h3> -->
											<!-- <i class="pe-7s-graph2 fa-4x pull-right"></i> -->
											<div class="clear"></div><!-- end clear -->
											<p class="rated_companies__counter">
												<span class="text-success">{{ n_companies }}</span>
												<!-- <h1 class="text-success">275</h1> -->
											</p>
											<small>
												Rated Companies
												<br />
												in this view
											</small>
										</div>
									<!-- </div> -->
								<!-- </div> -->
							</div>
						</div>
					</div>
					<!-- <div class="panel-footer">
						This is standard panel footer
					</div> -->
				</div>
			</div>
			<!-- end col-lg-6 -->

<!-- row 2 panel 1 -->

			<!-- <div class="col-lg-3 animated-panel">

			<div class="hpanel stats ">
				<div class="panel-heading">
					&nbsp;
				</div>
					<div class="panel-body h-200 -handle">
						<div class="stats-title pull-left">
							<h4>Total 2015 Solicitations</h4>
						</div>
						<div class="stats-icon pull-right">
							<i class="pe-7s-share fa-4x"></i>
						</div>
						<div class="m-t-xl">
							<h3 class="m-b-xs">1233</h3>
					<span class="font-bold no-margins">
						Social users
					</span>

							<div class="progress m-t-xs full progress-small">
								<div style="width: 55%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="55" role="progressbar" class=" progress-bar progress-bar-success">
									<span class="sr-only">35% Complete (success)</span>
								</div>
							</div>

							<div class="row">
								<div class="col-xs-6 animated-panel">
									<small class="stats-label">Another Value</small>
									<h4>7.80</h4>
								</div>

								<div class="col-xs-6 animated-panel">
									<small class="stats-label">Some Value</small>
									<h4>76.43%</h4>
								</div>
							</div>
						</div>
					</div>
					<div class="panel-footer">
						This is standard panel footer
					</div>
				</div>

			</div> --><!-- col-lg-3 -->


<!-- row 2 panel 2 -->

			<!-- <div class="col-lg-3 animated-panel">

				<div class="hpanel stats ">
					<div class="panel-heading">
						&nbsp;
					</div>
					<div class="panel-body h-200 -handle">
						<div class="stats-title pull-left">
							<h4>Active Portfolios</h4>
						</div>
						<div class="stats-icon pull-right">
							<i class="pe-7s-monitor fa-4x"></i>
						</div>
						<div class="m-t-xl">
							<h1 class="text-success">36</h1>
					<span class="font-bold no-margins">
						Portfolios
					</span>
							<br>
							<small>
Number of active porfolios created by users of your accounts
							</small>
						</div>
					</div>
					<div class="panel-footer">
						This is standard panel footer
					</div>
				</div>



			</div> --><!-- col-lg-3-->





		<!-- row 2 panel 3-4 -->

				<div class="col-lg-6 animated-panel">


					<div class="hpanel stats ">
						<!-- <div class="panel-heading">
							Risk Distribution by Risk level
						</div> -->
						<div class="panel-body h-200-handle" style="padding: 0;">
							<div class="myDoughnutChart_container">
							<div class="font-bold text-center m-b-sm">RISK DISTRIBUTION</div>
								<div class="myDoughnutChart_cell">
									<!-- <div class="myDoughnutChart_center_caption">
										Risk<br /> distribution
									</div> -->
									<canvas id="myDoughnutChart" width="150" height="150"></canvas>
								</div>
							</div>
							<ul class="myDoughnutChart_index">
								<li>
									<p class="myDoughnutChart_index__value myDoughnutChart_index--blue">
										{{ average_fhr }}
										<!-- <span class="print_visible">61.9</span><span class="print_hidden">{{ average_fhr }} ({{ average_risk }})</span> -->
									</p>
									<p class="myDoughnutChart_index__legend myDoughnutChart_index--blue">Very Low Risk</p>
									<p class="myDoughnutChart_index__title">AVG FHR</p>
								</li>
								<li>
									<p class="myDoughnutChart_index__value myDoughnutChart_index--green">{{ average_chs }}</p>
									<p class="myDoughnutChart_index__legend myDoughnutChart_index--green">Low Risk</p>
									<p class="myDoughnutChart_index__title">AVG CORE HEALTH</p>
								</li>
								<li>
									<p class="myDoughnutChart_index__value">{% if average_fhr_delta > 0 %}+{% endif %}{{ average_fhr_delta }}</p>
									<p class="myDoughnutChart_index__legend">&nbsp;</p>
									<p class="myDoughnutChart_index__title">AVG ANNUAL DELTA</p>
								</li>
							</ul>
							<div id="myDoughnutChart_legend"></div>
							<div class="clear"></div><!-- end clear -->
						</div>
						<!-- <div class="panel-footer">
							Open Solicitations
						</div> -->
					</div>



				</div>


		</div> <!-- end of the second row of four charts -->

		<!-- row 1 -->
		<div class="row">
			<div class="col-lg-12 animated-panel">
				<div class="hpanel">
					<!-- <div class="panel-heading">
						<div class="panel-tools">
							<a class="showhide"><i class="fa fa-chevron-up"></i></a>
							<a class="closebox"><i class="fa fa-times"></i></a>
						</div>
						Dashboard information and statistics
					</div> -->
					<div class="panel-body -handle">
						<div class="row">
							<div class="col-md-3 text-center animated-panel">
								<div class="">
									<i class="pe-7s-look" style="font-size:15px;"></i> PUBLIC RATINGS
								</div>
								<div>
									<h1 class="font-extra-bold m-t-xl m-b-xs">
										{{ n_public }}
									</h1>
									<small>Rated in this view</small>
								</div>
								<!-- <div class="small m-t-xl">
									<i class="fa fa-clock-o"></i> Data current as of 08:00 GMT
								</div> -->
							</div>
							<div class="col-md-6 animated-panel">
								<!-- <div class="text-center small">
									<i class="fa fa-laptop"></i> Jon to change this chart
								</div> -->
								<div class="flot-chart" style="height: 160px; margin: 0 33px 0 24px;">
									<div class="aside_caption_number_of_companies">Number of Companies</div>
									<div class="aside_caption_FHR">FHR</div>
									<div class="flot-chart-content" id="flot-line-chart"></div>
								</div>
							</div>
							<div class="col-md-3 text-center animated-panel">
								<div class="">
									<i class="pe-7s-lock" style="font-size:15px;"></i> PRIVATE RATINGS
								</div>
								<div>
									<h1 class="font-extra-bold m-t-xl m-b-xs">
										{{ n_private }}
									</h1>
									<small>Rated in this view</small>
								</div>
								<!-- <div class="small m-t-xl">
									<i class="fa fa-clock-o"></i> Last active in 12.10.2015
								</div> -->
							</div>
						</div>
					</div>
					<div class="panel-footer">
					<!-- <span class="pull-right">
						  You have two new messages from <a href="">Nitin Walia</a>
					</span> -->
						Last update: {{ update_date }}
						<span class="pull-right" style="position: relative;">
							<div class="flot-line-chart_hist_dist_container">
								<div class="flot-chart" style="height: 30px; width: 100px;">
									<div class="flot-chart-content" id="flot-line-chart_hist_dist"></div>
								</div>
							</div>
							Distribution of Historical Defaults
						</span>
					</div>
				</div>
			</div>
		</div>



		
		<!-- row 3 -->
		<div class="row">

		<!-- row 3 panel 1 -->

			<div class="col-lg-6 animated-panel">
				<div class="hpanel stats ">
					<div class="panel-heading">
						Risk Distribution by Country
					</div>
					<div class="panel-body h-200 -handle" style="padding: 0;">
						<div class="rritest_risk header_style_wrapper">
							<table class="rritest_risk header_style">
								<tr>
									<td>
										<table class="rritest_risk_table_left">
											<tr>
												<td>Country</td>
												<td>Average<br /> FHR</td>
												<td>No.<br /> Companies</td>
											</tr>
										</table>
										<table class="rritest_risk_table_right rwd_display_none">
											<tr>
												<td>Risk Category Distribution</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</div>
						<div class="rritest_risk_table_scroll">
					{% for country in countries %}
					<table class="rritest_risk">
						<tbody><tr>
							<td>
								<table class="rritest_risk_table_left">
									<tbody><tr>
										<td class="rritest_risk_table_left_hover">{{ country.name }}</td>
										<td class="rritest_risk_table_left_to_hide">{{ country.average_fhr }}</td>
										<td class="rritest_risk_table_left_to_hide">{{ country.n_companies }}</td>
										{% if country.name == 'Global Average' %}
										<td class="rritest_risk_table_left_to_show">Global Avg FHR</td>
										{% elif country.analysis %}
										<!-- <td class="rritest_risk_table_left_to_show">{{ country.name }} Avg FHR<br/>Global Avg FHR</td> -->
										<td class="rritest_risk_table_left_to_show">Country Avg FHR<br/>Global Avg FHR</td>
										{% else %}
										<td class="rritest_risk_table_left_to_show"></td>
										{% endif %}
									</tr>
								</tbody></table>
								{% if country.analysis %}
									<table class="rritest_risk_table_right">
										<tbody><tr>
											<td class="rritest_risk_table_right_to_show">
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container_to_hide" style="opacity: 0.9;">
													<div class="rritest_risk_table_indicator_red" style="width: {{ country.risk_distribution.VHR }}%;"></div>
													<div class="rritest_risk_table_indicator_orange" style="width: {{ country.risk_distribution.HR }}%;"></div>
													<div class="rritest_risk_table_indicator_light_orange" style="width: {{ country.risk_distribution.MR }}%;"></div>
													<div class="rritest_risk_table_indicator_green" style="width: {{ country.risk_distribution.LR }}%;"></div>
													<div class="rritest_risk_table_indicator_blue" data-width="50" style="width: {{ country.risk_distribution.VLR }}%;"></div>
												</div>
												{% if country.name != 'Global Average' %}
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container--global">
													<div class="rritest_risk_table_indicator_compare" style="width: {{ country.average_fhr }}%	!important;">
														<span class="rritest_risk_table_indicator_fhr">{{ country.average_fhr }}</span>
													</div>
												</div>
												{% endif %}
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container--global">
													<br />
													<div class="rritest_risk_table_indicator_compare_global" style="width: {{ global_average_fhr }}% !important;">
														<span class="rritest_risk_table_indicator_fhr">{{ global_average_fhr }}</span>
													</div>
												</div>
											</td>
										</tr>
									</tbody></table>
								{% else %}
								<table class="rritest_risk_table_right">
									<tbody><tr>
										<td class="rritest_risk_table_right_to_show">
											<div class="rritest_risk_table_indicator_message">
												Insufficient observations for this analysis
											</div>
										</td>
									</tbody></table>
								{% endif %}
							</td>
						</tr>
					</tbody></table>
					{% endfor %}
					</div><!-- end rritest_risk_table_scroll -->
					</div>
				</div>
			</div>



	








		<!-- row 3 panel 2 -->


			<div class="col-lg-6 animated-panel">
				<div class="hpanel stats ">
					<div class="panel-heading">
						Risk Distribution by Sector
					</div>
					<div class="panel-body h-200 -handle" style="padding: 0;">
						<div class="rritest_risk header_style_wrapper">
							<table class="rritest_risk header_style">
								<tr>
									<td>
										<table class="rritest_risk_table_left">
											<tr>
												<td>Country</td>
												<td>Average<br /> FHR</td>
												<td>No.<br /> Companies</td>
											</tr>
										</table>
										<table class="rritest_risk_table_right rwd_display_none">
											<tr>
												<td>Risk Category Distribution</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</div>
						<div class="rritest_risk_table_scroll">
					{% for sector in sectors %}
					<table class="rritest_risk">
						<tbody><tr>
							<td>
								<table class="rritest_risk_table_left">
									<tbody><tr>
										<td class="rritest_risk_table_left_hover">{{ sector.name }}</td>
										<td class="rritest_risk_table_left_to_hide">{{ sector.average_fhr }}</td>
										<td class="rritest_risk_table_left_to_hide">{{ sector.n_companies }}</td>
										{% if sector.name == 'Global Average' %}
										<td class="rritest_risk_table_left_to_show">Global Avg FHR</td>
										{% elif sector.analysis %}
										<!-- <td class="rritest_risk_table_left_to_show">{{ sector.name }} Avg FHR<br/>Global Avg FHR</td> -->
										<td class="rritest_risk_table_left_to_show">Sector Avg FHR<br/>Global Avg FHR</td>
										{% else %}
										<td class="rritest_risk_table_left_to_show"></td>
										{% endif %}
									</tr>
								</tbody></table>
								{% if sector.analysis %}
									<table class="rritest_risk_table_right">
										<tbody><tr>
											<td class="rritest_risk_table_right_to_show">
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container_to_hide">
													<div class="rritest_risk_table_indicator_red" style="width: {{ sector.risk_distribution.VHR }}%;"></div>
													<div class="rritest_risk_table_indicator_orange" style="width: {{ sector.risk_distribution.HR }}%;"></div>
													<div class="rritest_risk_table_indicator_light_orange" style="width: {{ sector.risk_distribution.MR }}%;"></div>
													<div class="rritest_risk_table_indicator_green" style="width: {{ sector.risk_distribution.LR }}%;"></div>
													<div class="rritest_risk_table_indicator_blue" data-width="50" style="width: {{ sector.risk_distribution.VLR }}%;"></div>
												</div>
												{% if sector.name != 'Global Average' %}
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container--global">
													<div class="rritest_risk_table_indicator_compare" style="width: {{ sector.average_fhr }}%  !important;">
														<span class="rritest_risk_table_indicator_fhr">{{ sector.average_fhr }}</span>
													</div>
												</div>
												{% endif %}
												<div class="rritest_risk_table_indicator_container rritest_risk_table_indicator_container--global">
													<br />
													<div class="rritest_risk_table_indicator_compare_global" style="width: {{ global_average_fhr }}% !important;">
														<span class="rritest_risk_table_indicator_fhr">{{ global_average_fhr }}</span>
													</div>
												</div>
											</td>
										</tr>
									</tbody></table>
								{% else %}
									<table class="rritest_risk_table_right">
									<tbody><tr>
										<td class="rritest_risk_table_right_to_show">
											<div class="rritest_risk_table_indicator_message">
												Insufficient observations for this analysis
											</div>
										</td>
									</tbody></table>
								{% endif %}
							</td>
						</tr>
					</tbody></table>
					{% endfor %}
					</div><!-- end rritest_risk_table_scroll -->
					</div>
				</div>
			</div>
		</div>
		<!-- end row 3  -->

			<!-- Foote -->
	<footer class="footer">
		<!-- <span class="pull-right">
			Example text
		</span> -->
		<!-- Company 2015-2020 -->
		Version 3.1
	</footer>
			</div>








<!-- 	</div> --><!-- end content -->

	<!-- Right sidebar -->
	<!-- Right sidebar -->
	<!--
	<div id="right-sidebar" class="animated fadeInRight">

		<div class="p-m">
			<button id="sidebar-close" class="right-sidebar-toggle sidebar-button btn btn-default m-b-md"><i class="pe pe-7s-close"></i>
			</button>
			<div>
				<span class="font-bold no-margins"> Analytics </span>
				<br>
				<small> Lorem Ipsum is simply dummy text of the printing simply all dummy text.</small>
			</div>
			<div class="row m-t-sm m-b-sm">
				<div class="col-lg-6 ">
					<h3 class="no-margins font-extra-bold text-success">300,102</h3>

					<div class="font-bold">98% <i class="fa fa-level-up text-success"></i></div>
				</div>
				<div class="col-lg-6 ">
					<h3 class="no-margins font-extra-bold text-success">280,200</h3>

					<div class="font-bold">98% <i class="fa fa-level-up text-success"></i></div>
				</div>
			</div>
			<div class="progress m-t-xs full progress-small">
				<div style="width: 25%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="25" role="progressbar" class=" progress-bar progress-bar-success">
					<span class="sr-only">35% Complete (success)</span>
				</div>
			</div>
		</div>
		<div class="p-m bg-light border-bottom border-top">
			<span class="font-bold no-margins"> John Deere Chatter </span>
			<br>
			<small> Please draw attention to any portfolio or company issues you
			have below:</small>
			<div class="m-t-md">
				<div class="social-talk">
					<div class="media social-profile clearfix">
						<a class="pull-left">
							<img src="images/a1.jpg" alt="profile-picture">
						</a>

						<div class="media-body">
							<span class="font-bold">John Novak</span>
							<small class="text-muted">21.03.2015</small>
							<div class="social-content small">
								I've can verify I've reviewed all of the high risk companies in
								the Private Portfolios.
							</div>
						</div>
					</div>
				</div>
				<div class="social-talk">
					<div class="media social-profile clearfix">
						<a class="pull-left">
							<img src="images/a3.jpg" alt="profile-picture">
						</a>

						<div class="media-body">
							<span class="font-bold">Mark Smith</span>
							<small class="text-muted">14.04.2015</small>
							<div class="social-content">
								I can't find a rating for fooCorp. Should I just
								ask RRI? What's the process?
							</div>
						</div>
					</div>
				</div>
				<div class="social-talk">
					<div class="media social-profile clearfix">
						<a class="pull-left">
							<img src="images/a4.jpg" alt="profile-picture">
						</a>

						<div class="media-body">
							<span class="font-bold">Marica Morgan</span>
							<small class="text-muted">21.03.2015</small>

							<div class="social-content">
							Mark, just go to the Ratings Request section and
							submit it. They will figure out if it's public or
							private and you'll get an email as it works it's way
							through to a rating.
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="p-m">
			<span class="font-bold no-margins"> Some other stuff that could go
				on the side: </span>
			<div class="m-t-xs">
				<div class="row">
					<div class="col-xs-6 ">
						<small>Today</small>
						<h4 class="m-t-xs">$170,20 <i class="fa fa-level-up text-success"></i></h4>
					</div>
					<div class="col-xs-6 ">
						<small>Last week</small>
						<h4 class="m-t-xs">$580,90 <i class="fa fa-level-up text-success"></i></h4>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-6 ">
						<small>Today</small>
						<h4 class="m-t-xs">$620,20 <i class="fa fa-level-up text-success"></i></h4>
					</div>
					<div class="col-xs-6 ">
						<small>Last week</small>
						<h4 class="m-t-xs">$140,70 <i class="fa fa-level-up text-success"></i></h4>
					</div>
				</div>
			</div>
			<small> Lorem Ipsum is simply dummy text of the printing simply all dummy text.
				Many desktop publishing packages and web page editors.
			</small>
		</div>

	</div>
	-->


<!-- </div> -->






	
			<!-- end test panel -->					
		





		

{% endblock body_wrapper %}
